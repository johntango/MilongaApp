<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>Now Playing</title>
    <style>
      body {
        font-family: sans-serif;
        padding: 1rem;
        background: #111;
        color: #eee;
      }
      img {
        width: 500px;
        height: auto;
        margin-bottom: 1rem;
      }
      .meta {
        line-height: 1.6;
      }
    </style>
  </head>
  <body>
    <div class="meta" id="meta"></div>
    <img id="cover" src="" alt="Album Art" />
    <script>
      window.addEventListener("message", (event) => {
        const data = event.data;

        // Handle playlist review messages
        if (data.type === "review") {
          document.title = data.title || "Playlist Review";
          document.getElementById("cover").style.display = "none";
          document.getElementById("meta").innerHTML = data.html;
          return;
        }

        // Handle now playing messages
        const { tags, artUrl } = data;
        if (!tags) return;

        document.getElementById("cover").style.display = "block";
        document.getElementById("cover").src = artUrl;

        const lines = [
          `<h1>${tags.tags.title}</h1`,
          ` <h1> ${tags.tags.artist} </h1`,
          ` <h3> ${tags.tags.album} </h3`,
        ];

        document.getElementById("meta").innerHTML = lines.join("<br>");
      });
    </script>
  </body>
</html>
